<!--
  æ•°æ®æŠ¥è¡¨é¡µé¢ (é¦–é¡µ)
  å¯¹åº”åŸ Vue é¡¹ç›®çš„ StatsDashboard.vue
-->
<view class="stats-container">
  <!-- ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ -->
  <view class="stats-cards">
    <!-- ç´¯è®¡å½’æ¡£é‡‘é¢ -->
    <view class="card stat-card">
      <view class="stat-content">
        <view class="stat-header">
          <text class="stat-label">ç´¯è®¡å½’æ¡£é‡‘é¢</text>
          <view class="tag {{monthRate >= 0 ? 'tag-success' : 'tag-danger'}}">
            <text>{{monthRate >= 0 ? '+' : ''}}{{monthRate}}% ç¯æ¯”</text>
          </view>
        </view>
        <text class="stat-value">Â¥{{totalAmount}}</text>
        <text class="stat-footer">å…±è®¡ {{totalCount}} å¼ ç¥¨æ®</text>
      </view>
      <view class="stat-icon icon-success">
        <text class="icon-text">ğŸ’°</text>
      </view>
    </view>

    <!-- æœ¬æœˆæ”¯å‡º -->
    <view class="card stat-card">
      <view class="stat-content">
        <view class="stat-header">
          <text class="stat-label">æœ¬æœˆæ”¯å‡º</text>
          <view class="tag {{budgetStatus.type}}">
            <text>{{budgetStatus.text}}</text>
          </view>
        </view>
        <text class="stat-value">Â¥{{monthAmount}}</text>
        <text class="stat-footer">é¢„ç®—: Â¥{{monthBudget}}</text>
      </view>
      <view class="stat-icon icon-warning">
        <text class="icon-text">ğŸ’³</text>
      </view>
    </view>

    <!-- æœ€é«˜é¢‘åˆ†ç±» -->
    <view class="card stat-card">
      <view class="stat-content">
        <view class="stat-header">
          <text class="stat-label">æœ€é«˜é¢‘åˆ†ç±»</text>
        </view>
        <text class="stat-value category-value">{{topCategory}}</text>
        <text class="stat-footer">å æ¯” {{topPercent}}%</text>
      </view>
      <view class="stat-icon icon-primary">
        <text class="icon-text">ğŸ“Š</text>
      </view>
    </view>
  </view>

  <!-- å›¾è¡¨åŒºåŸŸ -->
  <view class="charts-section">
    <!-- åˆ†ç±»åˆ†å¸ƒ -->
    <view class="card chart-card">
      <view class="card-header">
        <text class="card-title">ğŸ“Š è´¹ç”¨ç±»å‹åˆ†å¸ƒ</text>
      </view>
      <view class="chart-content">
        <block wx:if="{{categoryData.length > 0}}">
          <view class="category-list">
            <view class="category-item" wx:for="{{categoryData}}" wx:key="name">
              <view class="category-info">
                <text class="category-icon">{{item.icon}}</text>
                <text class="category-name">{{item.name}}</text>
              </view>
              <view class="category-bar-wrapper">
                <view class="category-bar" style="width: {{item.percent}}%; background-color: {{item.color}};"></view>
              </view>
              <text class="category-percent">{{item.percent}}%</text>
            </view>
          </view>
        </block>
        <view wx:else class="empty-state">
          <text class="empty-text">æš‚æ— æ•°æ®</text>
        </view>
      </view>
    </view>

    <!-- æ”¯å‡ºè¶‹åŠ¿ -->
    <view class="card chart-card">
      <view class="card-header">
        <text class="card-title">ğŸ“ˆ æ”¯å‡ºè¶‹åŠ¿</text>
        <view class="tag tag-warning">
          <text>AI é¢„æµ‹</text>
        </view>
      </view>
      <view class="chart-content">
        <block wx:if="{{trendData.length > 0}}">
          <view class="trend-chart">
            <view class="trend-bars">
              <view class="trend-bar-item" wx:for="{{trendData}}" wx:key="month">
                <view 
                  class="trend-bar {{item.isPrediction ? 'prediction' : ''}}" 
                  style="height: {{item.height}}%;"
                ></view>
                <text class="trend-month">{{item.monthLabel}}</text>
              </view>
            </view>
          </view>
          <view class="trend-legend">
            <view class="legend-item">
              <view class="legend-dot actual"></view>
              <text class="legend-text">å®é™…æ”¯å‡º</text>
            </view>
            <view class="legend-item">
              <view class="legend-dot prediction"></view>
              <text class="legend-text">AI é¢„æµ‹</text>
            </view>
          </view>
        </block>
        <view wx:else class="empty-state">
          <text class="empty-text">æš‚æ— æ•°æ®</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·å…¥å£ -->
  <view class="card quick-entry">
    <view class="card-header">
      <text class="card-title">âš¡ å¿«æ·æ“ä½œ</text>
    </view>
    <view class="entry-grid">
      <view class="entry-item" bindtap="goToUpload">
        <view class="entry-icon">ğŸ“¤</view>
        <text class="entry-text">æ™ºèƒ½å½’æ¡£</text>
      </view>
      <view class="entry-item" bindtap="goToList">
        <view class="entry-icon">ğŸ“‹</view>
        <text class="entry-text">æŸ¥çœ‹è®°å½•</text>
      </view>
      <view class="entry-item" bindtap="goToBudget">
        <view class="entry-icon">ğŸ’°</view>
        <text class="entry-text">é¢„ç®—ç®¡ç†</text>
      </view>
      <view class="entry-item" bindtap="goToAnalysis">
        <view class="entry-icon">ğŸ¤–</view>
        <text class="entry-text">AI åˆ†æ</text>
      </view>
    </view>
  </view>
</view>
