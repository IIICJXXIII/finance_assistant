<!--
  AI èšç±»åˆ†æé¡µé¢
-->
<view class="analysis-container">
  <view class="card intro-card">
    <view class="intro-icon">ğŸ¤–</view>
    <text class="intro-title">AI æ¶ˆè´¹èšç±»åˆ†æ</text>
    <text class="intro-desc">åŸºäº K-Means ç®—æ³•ï¼Œæ™ºèƒ½åˆ†ææ‚¨çš„æ¶ˆè´¹è¡Œä¸ºï¼Œè¯†åˆ«æ¶ˆè´¹æ¨¡å¼</text>
    <button class="btn btn-primary analyze-btn" bindtap="startAnalysis" loading="{{analyzing}}">
      {{analyzing ? 'åˆ†æä¸­...' : 'å¼€å§‹åˆ†æ'}}
    </button>
  </view>

  <view wx:if="{{analyzed}}">
    <!-- åˆ†æç»“æœæ¦‚è§ˆ -->
    <view class="card result-card">
      <view class="card-header">
        <text class="card-title">ğŸ“Š åˆ†æç»“æœ</text>
      </view>
      
      <view class="result-summary">
        <view class="summary-item">
          <text class="summary-value">{{clusterCount}}</text>
          <text class="summary-label">æ¶ˆè´¹ç±»ç¾¤</text>
        </view>
        <view class="summary-item">
          <text class="summary-value">{{dataCount}}</text>
          <text class="summary-label">åˆ†ææ ·æœ¬</text>
        </view>
        <view class="summary-item">
          <text class="summary-value">{{mainPattern}}</text>
          <text class="summary-label">ä¸»è¦æ¨¡å¼</text>
        </view>
      </view>
    </view>

    <!-- èšç±»è¯¦æƒ… -->
    <view class="card">
      <view class="card-header">
        <text class="card-title">ğŸ¯ ç±»ç¾¤åˆ†å¸ƒ</text>
      </view>
      
      <view class="cluster-list">
        <view 
          class="cluster-item"
          wx:for="{{clusters}}"
          wx:key="id"
        >
          <view class="cluster-header">
            <view class="cluster-badge" style="background-color: {{item.color}};">
              <text>{{item.name}}</text>
            </view>
            <text class="cluster-count">{{item.count}} æ¡è®°å½•</text>
          </view>
          <view class="cluster-info">
            <text class="cluster-desc">{{item.description}}</text>
          </view>
          <view class="cluster-stats">
            <view class="stat">
              <text class="stat-label">å¹³å‡é‡‘é¢</text>
              <text class="stat-value">Â¥{{item.avgAmount}}</text>
            </view>
            <view class="stat">
              <text class="stat-label">å æ¯”</text>
              <text class="stat-value">{{item.percent}}%</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- AI å»ºè®® -->
    <view class="card">
      <view class="card-header">
        <text class="card-title">ğŸ’¡ AI å»ºè®®</text>
      </view>
      <view class="suggestion-list">
        <view class="suggestion-item" wx:for="{{suggestions}}" wx:key="*this">
          <text class="suggestion-icon">âœ¨</text>
          <text class="suggestion-text">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- AI åˆ†ææŠ¥å‘Š -->
    <view class="card" wx:if="{{aiAnalysis}}">
      <view class="card-header">
        <text class="card-title">ğŸ¤– AI æ·±åº¦åˆ†ææŠ¥å‘Š</text>
      </view>
      <view class="ai-report">
        <text class="ai-report-text">{{aiAnalysis}}</text>
      </view>
    </view>
  </view>
</view>
